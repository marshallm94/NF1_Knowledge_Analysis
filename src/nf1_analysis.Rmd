---
title: "NF1 Thesis Analysis"
author: "Marshall McQuillen"
date: "8/19/2019"
output: 
  pdf_document: 
    latex_engine: xelatex
    toc: true
    toc_depth: 2
---

```{r, include=FALSE, eval=TRUE}
# set global options
knitr::opts_chunk$set(echo = FALSE,
                      eval = TRUE)
# This 'save_image' variable determines whether all the images in the report should be saved to a separate images
# directory, or whether they should be printed in this report. FALSE means that the images will be printed
# in the report and not saved to file.
save_images <- FALSE
```

# Overview

The paper that this analysis was created for was submitted for publication in "The Journal Of Genetic Counseling." As the journal name implies, it's focus is on genetic counseling and not on the field of statistics, and therefore some of the nuances of the statistics had to be left out. This report will take a closer look at those nuances. The paper that was submitted is titled, "Assessment of the Impact of a Positive Family History and Genetic Counseling on Parental Knowledge of Neurofibromatosis Type 1 (NF1)."

\pagebreak

# Statistical Analysis

## Study Aims

The study had two hypotheses, namely:

1. Parental knowledge of NF1 is influenced by having a personal diagnosis of NF1.

2. Parental knowledge of NF1 can be increased by exposure to genetic counseling.

```{r test_setup}
# load packages
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(ggpubr))
suppressPackageStartupMessages(library(ltm))
suppressPackageStartupMessages(library(extrafont))

# load & setup data
grand.data <- read.csv("/Users/marshallmcquillen/Data_Science/NF1_Thesis/data/grand_data.csv")
grand.data$mode_of_inheritance <- ifelse(grand.data$does_your_childs_other_parent_have_nf1. == "No" & grand.data$do_you_have_nf1. == "No", "De Novo", "Inherited")

# original significance level
alpha <- 0.05

# Bonferroni Correction
adj.alpha <- alpha / 4

# create subsets on whether respondent has seend a genetic counselor
grand.data$seen_gc <- grand.data$have_you_ever_met_with_a_genetic_counselor.
seen.gc <- subset(grand.data,
                  seen_gc == "Yes")
not.seen.gc <- subset(grand.data,
                      seen_gc == "No")

# create subsets based on whether the respondent has NF1
unaffected <- subset(grand.data, group_id == "Unaffected")
other.parent.affected <- subset(grand.data, group_id == "Other Parent Affected")
affected <- subset(grand.data, group_id == "Affected")
```

## Data Overview & Cleaning

Prior to performing any statistical tests, some minor data cleaning was needed. The below lists all alterations made to the data for the purposes of this and the submitted paper.

There were a total of 303 responses to the questionare:

* 11 respondents were "Not sure" if they had NF1. These respondents were dropped from the data set since both study aims are contingent upon knowing this information.

* One respondent skipped the question, "Does your child's other parent have NF1?" This respondent was kept since they answered the question, "Do you have NF1?" and their answer to "Does your child's other parent have NF1?" was imputed as "No."

* One respondent skipped the question, "Doe you have NF1?" This respondent was dropped from the data set since both study aims are contingent upon knowing this information.

* 14 respondents do not have NF1 and are "Not sure," if the childs other parent has NF1. These respondents were dropped from the data set since both aims of the thesis are dependent on this information.

* Three additional respondents were dropped from the study due to leaving other questions that will be discussed blank.

```{r age_statistics}
# removing the "first" two ages from the age range (10 & 15), since I suspect these respondents thought the
# question was regarding the age of the diagnosed children
age.range <- range(sort(grand.data$age)[3:length(grand.data$age)], na.rm = TRUE)
age.mean <- mean(grand.data$age, na.rm = TRUE)
age.sd <- sd(grand.data$age, na.rm = TRUE)
```

After the above adjustments, the final data set contains 274 respondents, with an age ranging from `r age.range[1]` to `r age.range[2]` and a mean age of `r age.mean`. The standard deviation of the ages is `r age.sd`.

## Approach 1

### Testing Methodology

In order to assess the first hypothesis of the study, to determine whether parental NF1 knowledge is influenced by the parent having a personal diagnosis of NF1, respondents were asked whether they or their affected child's other parent has NF1. This split the respondents into three groups:

* The **Unaffected** group - Respondents who do not have NF1 and the child's other parent also does not have NF1.

* The **Other Parent Affected** group - Respondents who do not have NF1 and the child's other parent does have NF1.

* The **Affected** group - Respondents who do have NF1 and the child's other parent does not have NF1.

\pagebreak

Originally, since we (myself and the PI of the study) knew we wanted to compare each of the three groups to the other two, I decided to forgo an initial ANOVA and go straight to the pairwise comparisons. Therefore, the three tests, and their accompanying hypotheses are as follows:

\hfill

1. Test 1 hypothesis: The "Unaffected" group and the "Other Parent Affected" group do not have the same mean NF1 knowledge score, as measured by the knowledge questionaire.
    * $H_0:~\mu_{unaffected} = \mu_{other~parent~affected}$
    * $H_a:~\mu_{unaffected} \ne \mu_{other~parent~affected}$
    
2. Test 2 hypothesis: The "Unaffected" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is greater than that of the "Affected" group.
    * $H_0:~\mu_{unaffected} \leq \mu_{affected}$
    * $H_a:~\mu_{unaffected} > \mu_{affected}$
    
3. Test 3 hypothesis: The "Other Parent Affected" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is greater than that of the "Affected" group.
    * $H_0:~\mu_{other~parent~affected} \leq \mu_{affected}$
    * $H_a:~\mu_{other~parent~affected} > \mu_{affected}$

\hfill
    
Although the variance of test scores are very close to each other, the sample sizes are not (see *Table 1. Study Aim 1: Sample Statistics*), leading to the choice of Welch's *t*-test as the statistical test to be used since it doesn't assume equal variances nor equal sample sizes.

The second hypothesis of the study, to determine whether parental knowledge of NF1 can be increased by exposure to genetic counseling, was also tested using Welch's *t*-test for the same reasons as mentioned above (see *Table 2. Study Aim 2: Sample Statistics*). The hypothesis for this test are below.

\hfill

4. Test 4 hypothesis: The mean NF1 knowledge score, as measured by the knowledge questionaire, of those who have had exposure to genetic counseling is greater than that of those who have not had exposure to genetic counseling.
    * $H_0:~\mu_{seen~GC} \leq \mu_{not~seen~GC}$
    * $H_a:~\mu_{seen~GC} > \mu_{not~seen~GC}$

\hfill

In order to control the Family-Wise Type I error rate, the original significance level ($\alpha$ = `r alpha`) was adjusted using the Bonferroni Correction, reducing the level of statistical significance to $\alpha_{adj}$ = `r adj.alpha`.

```{r group_summary_table}
# study aim 1
summary.df <- data.frame(Mean = c(mean(unaffected$score),
                                  mean(other.parent.affected$score),
                                  mean(affected$score)),
                         Variance = c(var(unaffected$score),
                                      var(other.parent.affected$score),
                                      var(affected$score)),
                         N = c(length(unaffected$score),
                               length(other.parent.affected$score),
                               length(affected$score)))
rownames(summary.df) <- c('Unaffected','Other Parent Affected','Affected')
knitr::kable(summary.df,
             caption = "Study Aim 1: Sample Statistics")

# study aim 2
summary.df <- data.frame(Mean = c(mean(seen.gc$score),
                                  mean(not.seen.gc$score)),
                         Variance = c(var(seen.gc$score),
                                      var(not.seen.gc$score)),
                         N = c(length(seen.gc$score),
                               length(not.seen.gc$score)))
rownames(summary.df) <- c('Has seen a Genetic Counselor','Has not seen a Genetic Counselor')
knitr::kable(summary.df,
             caption = "Study Aim 2: Sample Statistics")
```

This brings us to the tests for the first study aim.

### Study Aim 1 - Parental knowledge of NF1 is influenced by having a personal diagnosis of NF1.

#### Test 1

* $H_0:$ The "Unaffected" group has the same mean NF1 knowledge score, as measured by the knowledge questionaire, as the "Other Parent Affected" group.

* $H_a:$ The "Unaffected" group does not have the same mean NF1 knowledge score, as measured by the knowledge questionaire, as the "Other Parent Affected" group.

\hfill

```{r test_1}
if (save_images) {
    images_dir <- '../images/'
    if (!file.exists(images_dir)) {
        dir.create(images_dir)
    }
    filename <- 'UnaffectedvsOtherParentAffected.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}
# welch's t-test
test.1.results <- t.test(unaffected$score, other.parent.affected$score, var.equal = FALSE, alternative = 'two.sided')
test.1.data <- rbind.data.frame(unaffected, other.parent.affected)

subtitle <- paste("Mean's of each group displayed as vertical lines: Unaffected Group =", round(mean(unaffected$score), 4), "|", "Other Parent Affected Group =", round(mean(other.parent.affected$score), 4))

ggplot(test.1.data, aes(score, fill = group_id)) +
    geom_density(alpha = 0.5) +
    geom_vline(xintercept = mean(unaffected$score), color = 'orange') +
    geom_vline(xintercept = mean(other.parent.affected$score), color = 'darkgreen') +
    theme(legend.position="bottom") +
    theme(legend.title=element_blank()) +
    scale_fill_manual(values = c('darkgreen','orange')) +
    ggtitle("Unaffected Group vs. Other Parent Affected Group",
            subtitle = subtitle) +
    theme(plot.subtitle=element_text(size=8, face="italic", color="black")) +
    xlab("Test Score") +
    ylab("Density")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
print(paste("Test 1 p value =", test.1.results$p.value))
```

Welch's two-tailed $t$-Test returns the above p value, with which we fail to reject the null hypothesis.

\pagebreak

#### Test 2

* $H_0:$ The "Unaffected" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is less than or equal to that of the "Other Parent Affected" group.

* $H_a:$ The "Unaffected" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is greater than that of the "Affected" group.

\hfill

```{r test_2}
if (save_images) {
    filename <- 'UnaffectedvsAffected.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}
# welch's t-test
test.2.results <- t.test(unaffected$score, affected$score, var.equal = FALSE, alternative = 'greater')
test.2.data <- rbind.data.frame(unaffected, affected)

subtitle <- paste("Mean's of each group displayed as vertical lines: Unaffected Group =", round(mean(unaffected$score), 4), "|", "Affected Group =", round(mean(affected$score), 4))

ggplot(test.2.data, aes(score, fill = group_id)) +
    geom_density(alpha = 0.5) +
    geom_vline(xintercept = mean(unaffected$score), color = 'orange') +
    geom_vline(xintercept = mean(affected$score), color = 'purple') +
    theme(legend.position="bottom") +
    theme(legend.title=element_blank()) +
    scale_fill_manual(values = c('purple','orange')) +
    ggtitle("Unaffected Group vs. Affected Group",
            subtitle = subtitle) +
    theme(plot.subtitle=element_text(size=8, face="italic", color="black")) +
    xlab("Test Score") +
    ylab("Density")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
print(paste("Test 2 p value =", test.2.results$p.value))
```

Welch's one-sided *t*-test returns the above p value. Being well below the Bonferroni corrected significance level of `r adj.alpha`, $H_0$ is rejected in favor $H_a$.

\pagebreak

#### Test 3

* $H_0:$ The "Other Parent Affected" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is less than or equal to that of the "Affected" group.

* $H_a:$ The "Other Parent Affected" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is greater than that of the "Affected" group.

\hfill

```{r test_3}
if (save_images) {
    filename <- 'OtherParentAffectedvsAffected.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}
# welch's t-test
test.3.results <- t.test(other.parent.affected$score, affected$score, var.equal = FALSE, alternative = 'greater')
test.3.data <- rbind.data.frame(other.parent.affected, affected)

subtitle <- paste("Mean's of each group displayed as vertical lines: Other Parent Affected Group =", round(mean(other.parent.affected$score), 4), "|", "Affected Group =", round(mean(affected$score), 4))

ggplot(test.3.data, aes(score, fill = group_id)) +
    geom_density(alpha = 0.5) +
    geom_vline(xintercept = mean(other.parent.affected$score), color = 'darkgreen') +
    geom_vline(xintercept = mean(affected$score), color = 'purple') +
    theme(legend.position="bottom") +
    theme(legend.title=element_blank()) +
    scale_fill_manual(values = c('purple','darkgreen')) +
    ggtitle("Other Parent Affected Group vs. Affected Group",
            subtitle = subtitle) +
    theme(plot.subtitle=element_text(size=8, face="italic", color="black")) +
    xlab("Test Score") +
    ylab("Density")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
print(paste("Test 3 p value =", test.3.results$p.value))
```

Welch's one-sided $t$-Test returns the above p value. Being well below the Bonferroni corrected significance level of `r adj.alpha`, $H_0$ is rejected in favor $H_a$.

\pagebreak

### Study Aim 2 - Parental knowledge of NF1 can be increased by exposure to genetic counseling.

#### Test 4

* $H_0:$ The "Seen GC" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is less than or equal to that of the "Not Seen GC" group.

* $H_a:$ The "Seen GC" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is greater than that of the "Not Seen GC" group.

\hfill

```{r test_4}
if (save_images) {
    filename <- 'SeenGCvsNotSeenGC.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}
# welch's t-test
test.4.results <- t.test(seen.gc$score, not.seen.gc$score, var.equal = FALSE,
       alternative = 'greater')
test.4.data <- rbind.data.frame(seen.gc, not.seen.gc)

subtitle <- paste("Mean's of each group displayed as vertical lines: Yes =", round(mean(seen.gc$score), 4), "|", "No =", round(mean(not.seen.gc$score), 4))

ggplot(test.4.data, aes(score, fill = seen_gc)) +
    geom_density(alpha = 0.5) +
    geom_vline(xintercept = mean(not.seen.gc$score), color = '#F8766D') +
    geom_vline(xintercept = mean(seen.gc$score), color = '#00BFC4') +
    theme(legend.position="bottom") +
    theme(legend.title=element_blank()) +
    ggtitle("Have you seen a Genetic Counselor?",
            subtitle = subtitle) +
    theme(plot.subtitle=element_text(size=8, face="italic", color="black")) +
    xlab("Test Score") +
    ylab("Density")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}

print(paste("Test 4 p value =", test.4.results$p.value))
```

Welch's one-sided $t$-Test returns the above p value. Being well below the Bonferroni corrected significance level of `r adj.alpha`, $H_0$ is rejected in favor $H_a$.

\pagebreak

## Approach 2

Upon initial submission of the paper, the editor of the journal noted that the "statistical norms" of studies in the Journal of Genetic Counseling (JOGC) are to use an ANOVA followed by post-hoc pairwise comparisons should the ANOVA prove significant. In addition, should the paper be published in black and white, the above images wouldn't be as clear as they could be. With these suggestions in mind, the analysis and images were redone to fit the guidelines of the journal.

### Study Aim 1 - Parental knowledge of NF1 is influenced by having a personal diagnosis of NF1.

#### ANOVA

Since there are three groups that need to be tested ("Affected", "Other Parent Affected" and "Unaffected"), an ANOVA test will determine whether there is evidence that at least one group mean is different from the others.

* $H_0$: There is no difference in mean NF1 knowledge score, as measured by the knowledge questionaire, between the three groups ("Affected", "Other Parent Affected" and "Unaffected").

* $H_a$: At least one group has a different mean NF1 knowledge score, as measured by the knowledge questionaire, than the other groups.

```{r anova_plot}
if (save_images) {
    filename <- 'ANOVAComparison.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}
par(mar=c(4.5,4.1,4.1,2.1))
boxplot(score ~ group_id,
        data = grand.data,
        ylim=c(0.5, 1),
        yaxt = 'n',
        xlab = NULL,
        ylab = NULL)
title(main = 'One Way ANOVA',
      ylab = 'Survey Score',
      xlab = 'Group',
      font.lab = 2)
text(x=2, y=0.55, "*p < 0.001", pos=3, cex=1, font = 4)
axis(side=2, at=pretty(seq(0.5, 1, 0.1)), labels=paste0(pretty(seq(0.5, 1, 0.1)*100), "%"), las=2)

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

```{r anova_test}
anova.result <- aov(score ~ group_id,
                    data = grand.data)
summary(anova.result)
```

The one way ANOVA, *F*(2, 271) = 7.794, *p* = 0.000511, shows that there is ample evidence for the alternate hypothesis, which is accepted and followed up with the pairwise comparisons.

\pagebreak

#### Tukey's HSD

Following the ANOVA result with Tukey's Honestly Significant Difference (HSD) test, it is shown that the "Affected" group has a significantly lower NF1 knowledge score, as measure by the knowledge questionaire, than the other two groups. A significant difference between the "Unaffected" and "Other Parent Affected" groups was not found.

```{r tukey_hsd}
tukey.hsd.result<- TukeyHSD(anova.result)

knitr::kable(tukey.hsd.result$group_id[,4],
             caption = 'Tukey HSD Results',
             col.names = '(Adj.) P value',
             label = 'test')
```

```{r pairwise_comparisons}
summary_df <- grand.data %>% group_by(group_id) %>% summarise(average = mean(score))

test.1 = summary_df[1:2,]
test.1$Test = 'Test 1'

test.2 = summary_df[c(1,3),]
test.2$Test = 'Test 2'

test.3 = summary_df[2:3,]
test.3$Test = 'Test 3'

summary_df <- rbind(test.1, test.2, test.3)

if (save_images) {
    filename <- 'PairwiseComparison.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

# plot settings
col = c('black','gray','black','white','gray','white')
legend_col = c('black','grey','white')

par(family = 'Times New Roman')
#par(mar=c(2,5,2,5),
#    lwd=2)
barplot(summary_df$average,
        beside=TRUE,
        ylim=c(0.5, 1),
        col=col,
        space=c(0,0,1,0,1,0),
        axes=FALSE,
        ylab='Average Survey Score',
        main="Pairwise Comparisons of NF1 Knowledge and Parental NF1 Status",
        font.lab = 2)
legend(x = 3.0, y = 1, legend=c('Self-Affected','Other Parent Affected','Unaffected'), fill=legend_col, cex=0.75)
axis(side=2, at=pretty(seq(0.5, 1, 0.1)), labels=paste0(pretty(seq(0.5, 1, 0.1)*100), "%"), las=2)
text(x=1.0, y=0.85, "*p = 0.004", pos=3, cex=1, font = 4)
text(x=4.0, y=0.85, "*p < 0.001", pos=3, cex=1, font = 4)
text(x=7.0, y=0.85, "p = 0.644", pos=3, cex=1, font = 3)

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

\pagebreak

### Study Aim 2 - Parental knowledge of NF1 can be increased by exposure to genetic counseling.

The testing methodology for the second study aim remained the same for both approaches, however the plot was changed to display the findings in a more traditional manner (hypotheses reproduced below)

\hfill

* $H_0:$ The "Seen GC" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is less than or equal to that of the "Not Seen GC" group.

* $H_a:$ The "Seen GC" group has a mean NF1 knowledge score, as measured by the knowledge questionaire, that is greater than that of the "Not Seen GC" group.

\hfill

```{r}
if (save_images) {
    filename <- 'GeneticCounselingExposure.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

par(mar=c(4.5,4.1,4.1,2.1),
    family = 'Times New Roman')
boxplot(score ~ have_you_ever_met_with_a_genetic_counselor.,
        data = grand.data,
        ylim=c(0.5, 1),
        yaxt = 'n',
        xlab = NULL,
        ylab = NULL)
axis(side=2, at=pretty(seq(0.5, 1, 0.1)), labels=paste0(pretty(seq(0.5, 1, 0.1)*100), "%"), las=2)
title(main = 'Relationship Between NF1 Knowledge and Exposure to Genetic Counseling',
      ylab = 'NF1 Knowledge Score',
      xlab = 'Have you ever met with a Genetic Counselor?',
      font.lab = 2)
text(x=1.5, y=0.95, "*p < 0.001", pos=3, cex=1, font = 4)

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

\hfill

```{r cronbachs_alpha, include=FALSE}
quiz.questions <- c('one_half_or_50._of_genetic_information_is_passed_down_from_mother_to_child',
                    'there_is_more_than_one_gene_that_causes_nf1',
                    'a_father_can_pass_down_an_nf1_gene_mutation_to_his_daughters',
                    'all_people_who_have_an_nf1_gene_mutation_will_develop_cancer',
                    'nf1_symptoms_vary_from_one_person_to_another',
                    'a_person_is_born_with_nf1',
                    'nf1_can_skip_generations',
                    'if_a_woman_with_nf1_has_one_child_with_nf1_her_second_child_will_definitely_not_have_nf1',
                    'people_with_nf1_are_generally_more_likely_to_develop_cancer_at_a_younger_age',
                    'if_a_woman_with_nf1_has_scoliosis_then_her_child_will_also_develop_scoliosis',
                    'tumors_in_nf1_can_appear_anywhere_in_the_body',
                    'people_with_nf1_from_different_families_will_always_have_different_symptoms',
                    'cafe.au.lait_spots_.brown_marks_on_the_skin._are_often_the_first_sign_that_a_person_has_nf1',
                    'a_baby_with_nf1_may_be_born_with_a_tumor',
                    'all_cases_of_nf1_can_be_detected_in_a_womans_pregnancy_by_ultrasound',
                    'half_of_people_with_nf1_have_a_family_history_of_nf1',
                    'a_person_with_nf1_can_develop_tumors_that_may_lead_to_vision_loss_or_blindness',
                    'women_with_nf1_are_at_an_increased_risk_for_breast_cancer',
                    'is_scoliosis_associated_with_nf1.',
                    'is_attention_deficit_hyperactivity_disorder_associated_with_nf1.',
                    'are_clubbed_feet_associated_with_nf1.',
                    'are_congenital_heart_defects_associated_with_nf1.',
                    'are_seizures_associated_with_nf1.',
                    'are_bumps_on_the_skin_associated_with_nf1.',
                    'are_allergies_associated_with_nf1.',
                    'is_high_blood_pressure_associated_with_nf1.',
                    'are_learning_disabilities_associated_with_nf1.',
                    'are_optic_gliomas_associated_with_nf1.',
                    'is_infertility_associated_with_nf1.',
                    'are_lisch_nodules_.dark_spots_on_the_iris._the_colored_part_of_the_eye._associated_with_nf1.',
                    'is_small_head_size_associated_with_nf1.',
                    'are_cataracts_associated_with_nf1.',
                    'how_is_nf1_diagnosed.',
                    'what_types_of_exams_may_be_helpful_when_trying_to_make_a_diagnosis_of_nf1.',
                    'what_causes_nf1.',
                    'what_is_the_function_of_the_nf1_gene_in_the_body.',
                    'are_men_or_women_more_likely_to_be_affected_by_nf1.',
                    'how_many_copies_of_a_non.working_nf1_gene_must_one_have_to_be_affected_with_nf1.',
                    'if_a_person_with_nf1_has_a_child_what_is_the_chance_that_the_child_will_have_nf1.',
                    'what_is_the_increased_risk_for_a_person_with_nf1_to_develop_cancer_in_their_lifetime_compared_to_someone_without_nf1.',
                    'during_childhood_what_kind_of_screening_may_be_done_for_optic_gliomas_.eye_tumors..',
                    'how_do_the_symptoms_of_nf1_change_as_a_person_gets_older.',
                    'what_is_the_most_concerning_symptom_of_a_tumor_to_suggest_it_has_become_malignant_.cancerous..')

quiz.df <- grand.data[, quiz.questions]
cronbachs <- cronbach.alpha(quiz.df)$alpha
```

## Cronbach's Alpha

Cronbach's alpha is a statistic used to measure the reliability of a set of test items, or more specifically, how well a set of test items (questions) measures the underlying concept which the test is attempting to assess. In the context of this thesis, Cronbach's Alpha can be interpreted as a numeric summary of how well the knowledge based questions assess a respondents true knowledge level of NF1.

Using 43 quiz questions returned a Cronbach's Alpha value of `r cronbachs`.

\pagebreak

## Statistical Theory: Approach 1 vs. Approach 2

The fact that both the above approaches produced the same result is a testament to the significance of the findings, however I believe it is worth diving into the theory of the two approaches, and in particular arguing that a one way ANOVA *F*-test was unnecessary in this case.

The null hypothesis of a one way ANOVA *F*-test is that the means of all groups tested are the same. That is,

$$H_o:\mu_1 = \mu_2 = \mu_3 \cdots \mu_k$$

Therefore, the alternate hypothesis of one way ANOVA is that *at least two* group means are unequal. That is,

$$H_a:at~least~one~pair~\mu_j \ne \mu_{j'}$$

Should a one way ANOVA *F*-test prove significant and the alternate hypothesis be accepted, the natural next question becomes, "Which pair(s) have different means?"

This is where post hoc comparisons come into play, such as the Bonferroni Correction, Fisher's Least Significant Difference (LSD) test and Tukey's Honestly Significant Difference (HSD) test (used in Approach 2), to name a few. While diving into the details of each of these methods is outside the scope of this paper and deserves focused research, their general purpose is to control the family-wise error rate (FWER), sometimes referred to as the experimentwise-alpha.

When one decides to correct for multiple comparisons, defining the bounds of a "family" of statistical tests has a large impact on the whether a particular test is deemed "significant," and, "there is no firm rule on this."$^{[1]}$ Some texts suggests that a "family" of tests are all tests, "conducted on the same data."$^{[2]}$ However, if this is the definition of "family" that is used, than post hoc tests inherently do *not* control the FWER by definition. Post hoc (latin: *After this*) tests, as the name implies, are performed after an initial test for significance is conducted (ANOVA in this and most cases) and ensure that the probability of a false positive among *any of the post hoc tests* does not exceed a certain threshold. Since there isn't a post hoc test that retroactively adjusts the significance level needed for the omnibus ANOVA to be deemed significant, post hoc procedures can only be said to control the FWER in so far as the "family" is defined as the pairwise post hoc tests. With this in mind, the ANOVA followed by post hoc tests method, the method used in Approach 2, has:

\begin{align}
FWER & = probability~of~at~least~one~Type~I~error~in~a~family~of~hypothesis~tests \\
& = P(H_a~Anova~falsely~accepted) + P(H_a~post~hoc~family~falsely~accepted) \\
& = 0.05 + 0.05 \\
& = 0.1
\end{align}

...if a "family" is defined as all tests that are conducted on the same sample.

In addition, in Approach 2, the adjustment to the significance level isn't extended to the test for the second study aim. Therefore, if included in the above calculation, the $FWER = 0.15$ after adding on the additional $0.05$ for the test that looks at the second study aim.

Conversely, since we (myself and the PI) knew at the outset that we wanted to compare the means of each of the three groups, ("Affected", "Other Parent Affected" and "Unaffected"), in addition to the "Met GC" vs. "Not Met GC" groups, Approach 1 seemed more reasonable. By defining a "family" of tests as all those that are conducted on the same sample, applying the Bonferroni Correction to all 4 tests gives each test equal weight and does in fact control the FWER at 0.05. Although the Bonferroni Correction is considered a convservative approach, this is outside the scope of this paper (again, deserves and has many of it's own papers), the significant levels only become overly conservative when $k>4$.

\hfill

```{r bonferroni_correction_demo}
x <- seq(1, 20, 1)
y <- alpha / x
if (!save_images) {
    qplot(x, y, xlab = 'K', main = "Significance level needed to determine significance in family of K tests", ylab = 'Significance Level')
}
```

\hfill

This last section barely scratched the surface of a few questions in statistical theory, however, as I said, this would have been out of place in the JOGC.

# Data Visualizations

```{r proportion_of_respondents_who_have_nf1}
if (save_images) {
    filename <- 'HaveNF1Percentage.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(grand.data, aes(do_you_have_nf1., fill = do_you_have_nf1.)) +
    geom_bar(aes(y = (..count..)/sum(..count..))) +
    geom_text(aes(y = ((..count..)/sum(..count..)),
                  label = scales::percent((..count..)/sum(..count..))),
              stat = "count",
              vjust = -0.25) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.position = 'bottom',
          legend.title = element_blank(),
          axis.ticks = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("Do you have have NF1?") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}


result <- table(grand.data$do_you_have_nf1.)
knitr::kable(result,
             caption = "Do you have NF1?",
             col.names = c('Response','Count'))
```

\hfill

```{r proportion_of_respondents_who_have_met_a_gc}
if (save_images) {
    filename <- 'PercentageMetGC.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(grand.data, aes(have_you_ever_met_with_a_genetic_counselor.,
                       fill = have_you_ever_met_with_a_genetic_counselor.)) +
    geom_bar(aes(y = (..count..)/sum(..count..))) +
    geom_text(aes(y = ((..count..)/sum(..count..)),
                  label = scales::percent((..count..)/sum(..count..))),
              stat = "count",
              vjust = -0.25) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.position = 'bottom',
          legend.title = element_blank(),
          axis.ticks = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("Have you ever met with a Genetic Counselor?") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}

result <- table(grand.data$have_you_ever_met_with_a_genetic_counselor.)
knitr::kable(result,
             caption = "Have you ever met with a Genetic Counselor?",
             col.names = c('Response','Count'))
```

\hfill

```{r employment_status}
grand.data$employment_status <- sub("^$", "Unknown", grand.data$employment_status)

display.df <- as.data.frame(grand.data %>%
    count(employment_status) %>%
    arrange(desc(n))) %>%
    mutate(employment_status = factor(employment_status, employment_status))

if (save_images) {
    filename <- 'EmploymentStatusDistribution.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(display.df, aes(x = reorder(employment_status, -n),
                       y = n,
                       fill = employment_status)) +
    geom_bar(aes(y = n/sum(display.df$n)), stat = 'identity') +
    geom_text(aes(y = n/sum(display.df$n),
                  label = scales::percent(n/sum(display.df$n))),
              vjust = -0.25) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.title = element_blank(),
          legend.position = 'bottom',
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("Employment Status") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}

result <- table(grand.data$employment_status)
knitr::kable(result,
             caption = "What is your employment status?",
             col.names = c('Response','Count'))
```

\pagebreak

```{r gender}
grand.data$gender <- sub("^$", "Unknown", grand.data$gender)

if (save_images) {
    filename <- 'GenderDistribution.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(grand.data, aes(gender,
                       fill = gender)) +
    geom_bar(aes(y = (..count..)/sum(..count..))) +
    geom_text(aes(y = ((..count..)/sum(..count..)),
                  label = scales::percent((..count..)/sum(..count..))),
              stat = "count",
              vjust = -0.25) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.title = element_blank(),
          legend.position = 'bottom',
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("Gender") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}

result <- table(grand.data$gender)
knitr::kable(result,
             caption = "Gender",
             col.names = c('Response','Count'))
```

\hfill

```{r ethnicity}
grand.data$ethnicity <- sub("^$", "Unkown", grand.data$ethnicity)

display.df <- as.data.frame(grand.data %>%
    count(ethnicity) %>%
    arrange(desc(n))) %>%
    mutate(ethnicity = factor(ethnicity, ethnicity))

if (save_images) {
    filename <- 'EthnicityDistribution.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(display.df, aes(x = reorder(ethnicity, -n),
                       y = n,
                       fill = ethnicity)) +
    geom_bar(aes(y = n/sum(display.df$n)), stat = 'identity') +
    geom_text(aes(y = n/sum(display.df$n),
                  label = scales::percent(n/sum(display.df$n))),
              vjust = -0.25) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.title = element_blank(),
          legend.position = 'bottom',
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("Ethnicity") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}


result <- table(grand.data$ethnicity)
knitr::kable(result,
             caption = "Ethnicity",
             col.names = c('Response \t','Count'))
```

\pagebreak

One person did not answer the question regarding their educational background, and therefore was excluded from the below plot.

\hfill

```{r educational_background}
levels(grand.data$educational_background) <- c('Unkown',
                                               levels(grand.data$educational_background)[2:length(levels(grand.data$educational_background))])
grand.data[is.na(grand.data$educational_background), "educational_background"] <- 'Unkown'

display.df <- as.data.frame(grand.data %>%
                                group_by(mode_of_inheritance) %>%
                                count(educational_background))

inherited <- display.df[display.df$mode_of_inheritance != 'De Novo', ] %>%
    mutate(percentage = n/sum(n)) %>%
    arrange(desc(percentage)) %>%
    mutate(educational_background = factor(educational_background, educational_background))

de.novo <- display.df[display.df$mode_of_inheritance == 'De Novo', ] %>%
    mutate(percentage = n/sum(n)) %>%
    arrange(desc(percentage)) %>%
    mutate(educational_background = factor(educational_background, educational_background))
                            
display.df <- rbind(de.novo, inherited)

if (save_images) {
    filename <- 'EducationDistribution.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(display.df, aes(x = educational_background,
                       y = percentage,
                       fill = educational_background)) +
    geom_bar(stat = 'identity') +
    facet_grid(~mode_of_inheritance) +
    geom_text(aes(y = percentage,
                  label = scales::percent(percentage)),
              vjust = -0.25) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.title = element_blank(),
          legend.position = 'bottom',
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("Educational Background") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}

result <- table(grand.data$educational_background)
knitr::kable(result[2:length(result)],
             caption = "Educational Background",
             col.names = c('Response \t','Count'))
```

\pagebreak

It is important to note that the answers to the below question, "What specialists does your affected child see?" are *not* mutually exclusive - children who see a Neurologist may have seen an Oncologist and a Geneticist as well. 

\hfill

```{r specialists_seen}
cols = c("does_your_oldest_child_see_a_neurologist_for_nf_care.",
         "does_your_oldest_child_see_an_oncologist_for_nf_care.",
         "does_your_oldest_child_see_a_geneticist_for_nf_care.",
         "does_your_oldest_child_see_an_ent.audiologist_for_nf_care.",
         "does_your_oldest_child_see_a_pediatrician_for_nf_care.",
         "does_your_oldest_child_see_a_dermatologist_for_nf_care.",
         "mode_of_inheritance")

display.df <- grand.data %>%
    group_by(mode_of_inheritance) %>%
    summarise(Neurologist = sum(does_your_oldest_child_see_a_neurologist_for_nf_care.),
              Oncologist = sum(does_your_oldest_child_see_an_oncologist_for_nf_care.),
              Geneticist = sum(does_your_oldest_child_see_a_geneticist_for_nf_care.),
              Audiologist = sum(does_your_oldest_child_see_an_ent.audiologist_for_nf_care.),
              Pediatrician = sum(does_your_oldest_child_see_a_pediatrician_for_nf_care.),
              Dermatologist = sum(does_your_oldest_child_see_a_pediatrician_for_nf_care.))
df.d <- melt(display.df, id.vars='mode_of_inheritance')

de.novo <- df.d[df.d$mode_of_inheritance == 'De Novo',] %>%
    arrange(desc(value)) %>%
    mutate(variable = factor(variable, variable))

inherited <- df.d[df.d$mode_of_inheritance != 'De Novo',] %>%
    arrange(desc(value)) %>%
    mutate(variable = factor(variable, variable))

df.d <- rbind(de.novo, inherited)

if (save_images) {
    filename <- 'SpecialistsByModeOfInheritcance.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(df.d, aes(x = reorder(variable, -value),
                 y = value,
                 fill = variable)) +
    geom_bar(stat = 'identity') +
    facet_grid(~mode_of_inheritance) +
    geom_text(aes(y = value, label = value),
              vjust = -0.25,
              size = 3) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),
          legend.position = 'none',
          axis.title.x = element_blank()) +
    ggtitle("What specialists does your affected child see?",
            "Faceted by mode of inheritance") +
    ylab("Count")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

\hfill

```{r frequency_of_visits}
if (save_images) {
    filename <- 'FrequencyOfVisitsByModeOfInheritance.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(grand.data, aes(how_often_does_your_.oldest._child_see_an_nf_doctor.,
                       y = (..count..)/sapply(PANEL, FUN=function (x) sum(count[PANEL == x])))) +
    geom_bar(aes(fill = how_often_does_your_.oldest._child_see_an_nf_doctor.)) +
    facet_grid(~mode_of_inheritance) +
    geom_text(aes(label = paste(round(((..count..)/sapply(PANEL, FUN=function (x) sum(count[PANEL == x])))*100,2),'%', sep = '')),
              stat = "count",
              vjust = -0.25,
              size = 3) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.title = element_blank(),
          legend.position = 'bottom',
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("How often does your oldest child see a NF1 doctor?") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}

result <- table(grand.data$how_often_does_your_.oldest._child_see_an_nf_doctor., grand.data$mode_of_inheritance)
knitr::kable(result,
             caption = "How often does your oldest child see a NF1 doctor?")
```

\pagebreak

```{r frequency_of_visits_vs_score}
display.df <- grand.data %>%
    group_by(how_often_does_your_.oldest._child_see_an_nf_doctor.) %>%
    summarise(mean_score = mean(score))
df.d <- melt(display.df, id.vars='how_often_does_your_.oldest._child_see_an_nf_doctor.')

if (save_images) {
    filename <- 'FrequencyOfVisitsVsQuizScore.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(df.d, aes(x = how_often_does_your_.oldest._child_see_an_nf_doctor., y = value, fill = how_often_does_your_.oldest._child_see_an_nf_doctor.)) +
    geom_bar(stat = 'identity') +
    scale_y_continuous(labels = scales::percent) +
    geom_text(aes(y = value, label = paste(round(value*100, 2), '%', sep = '')),
              vjust = -0.25,
              size = 3) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),
          legend.position = 'none',
          axis.title.x = element_blank()) +
    ggtitle("How often does your oldest child see a NF1 doctor?") +
    ylab("Mean Quiz Score")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

\hfill

```{r mode_of_inheritance_vs_seen_gc}
if (save_images) {
    filename <- 'MetGCByModeOfInheritance.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(grand.data, aes(have_you_ever_met_with_a_genetic_counselor.,
                       fill = have_you_ever_met_with_a_genetic_counselor.)) +
    geom_bar(aes(y = (..count..))) +
    facet_grid(~mode_of_inheritance) +
    geom_text(aes(y = (..count..),
                  label = (..count..)),
              stat = "count",
              vjust = -0.25) +
    theme(legend.title = element_blank(),
          legend.position = 'bottom',
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("Have you ever met with a Genetic Counselor?",
            "Faceted by mode of inheritance") +
    ylab("Count")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

\hfill

```{r severity_symptoms}
if (save_images) {
    filename <- 'SeverityOfSymptomsByModeOfInheritance.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(grand.data,
       aes(how_would_you_describe_the_severity_of_symptoms_of_your_.oldest._child_with_nf1.,
           y = (..count..)/sapply(PANEL, FUN=function (x) sum(count[PANEL == x])))) +
    geom_bar(aes(fill = how_would_you_describe_the_severity_of_symptoms_of_your_.oldest._child_with_nf1.)) +
    facet_grid(~mode_of_inheritance) +
    geom_text(aes(label = paste(round(((..count..)/sapply(PANEL, FUN=function (x) sum(count[PANEL == x])))*100,2),'%', sep = '')),
              stat = "count",
              vjust = -0.25,
              size = 3) +
    scale_y_continuous(labels = scales::percent) +
    theme(legend.title = element_blank(),
          legend.position = 'bottom',
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank(),
          axis.text.x = element_blank()) +
    ggtitle("How would you describe the severity of symptoms\nof your oldest child with NF1?",
            "Faceted by mode of inheritance") +
    ylab("Proportion")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}

result <- table(grand.data$how_would_you_describe_the_severity_of_symptoms_of_your_.oldest._child_with_nf1., grand.data$mode_of_inheritance)
knitr::kable(result,
             caption = "How would you describe the severity of symptoms of your oldest child with NF1?")
```

\pagebreak

Similar to the "What specialists does your affected child see?" plot, it is important to note that the answers to the below question, "Where do you obtain knowledge regarding NF1 should you have questions?" are not mutually exclusive - parents who ask their doctor might also reference online sources.

\hfill

```{r obtain_knowledge}
display.df <- grand.data %>%
  group_by(mode_of_inheritance) %>%
  summarize(
    Doctor = sum(if_you_have_questions_regarding_nf1_do_you_obtain_knowledge_from_your_doctor.),
    NF1Organization = sum(if_you_have_questions_regarding_nf1_do_you_obtain_knowledge_from_an_nf_organization_website.),
    FamilyMembers = sum(if_you_have_questions_regarding_nf1_do_you_obtain_knowledge_from_family_members_with_nf1.),
    OnlineSources = sum(if_you_have_questions_regarding_nf1_do_you_obtain_knowledge_from_online_searches.),
    SocialMedia = sum(if_you_have_questions_regarding_nf1_do_you_obtain_knowledge_from_social_media_sites_.such_as_facebook..),
    OtherFamilies = sum(if_you_have_questions_regarding_nf1_do_you_obtain_knowledge_from_other_families_you_know_that_have_nf1.),
    DontInvestigate = sum(if_you_have_questions_regarding_nf1_do_you_not_obtain_additional_information.))
display.df <- melt(display.df, 'mode_of_inheritance')

levels(display.df$variable) <- c('Doctor', 'NF1 Organization', 'Family Members', 'Online Sources', 'Social Media', 'Other Families', "Dont Investigate")

de.novo <- display.df[display.df$mode_of_inheritance == 'De Novo',] %>%
    arrange(desc(value)) %>%
    mutate(variable = factor(variable, variable))

inherited <- display.df[display.df$mode_of_inheritance != 'De Novo',] %>%
    arrange(desc(value)) %>%
    mutate(variable = factor(variable, variable))

display.df <- rbind(de.novo, inherited)

if (save_images) {
    filename <- 'ObtainKnowledgeByModeOfInheritance.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(display.df, aes(x = variable,
                       y = value,
                       fill = variable)) +
    geom_bar(stat = 'identity') +
    facet_grid(~mode_of_inheritance) +
    geom_text(aes(y = value, label = value),
              vjust = -0.25,
              size = 3) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),
          legend.position = 'none',
          axis.title.x = element_blank()) +
    ggtitle("Where do you obtain knowledge regarding NF1 should you have questions?",
            "Faceted by mode of inheritance") +
    ylab("Count")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

\hfill

```{r explained_medical_aspects}
display.df <- grand.data %>%
  group_by(mode_of_inheritance) %>%
  summarize(
    Doctor = sum(did_a_doctor_explain_the_medial_aspects_of_nf1_to_you.),
    GeneticCounselor = sum(did_a_genetic_counselor_explain_the_medial_aspects_of_nf1_to_you.),
    FamilyMembers = sum(did_a_family_member_explain_the_medial_aspects_of_nf1_to_you.),
    NoOne = sum(did_no_one_explain_the_medial_aspects_of_nf1_to_you.),
    NotSure = sum(are_you_not_sure_who_explained_the_medial_aspects_of_nf1_to_you.))
display.df <- melt(display.df, 'mode_of_inheritance')

levels(display.df$variable) <- c('Doctor','Genetic Counselor','Family Members','No One','Not Sure')

if (save_images) {
    filename <- 'MedicalExplanationByModeOfInheritance.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggplot(display.df, aes(x = reorder(variable, -value),
                       y = value,
                       fill = variable)) +
    geom_bar(stat = 'identity') +
    facet_grid(~mode_of_inheritance) +
    geom_text(aes(y = value, label = value),
              vjust = -0.25,
              size = 3) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),
          legend.position = 'none',
          axis.title.x = element_blank()) +
    ggtitle("Who explained the medical aspects of NF1 to you?",
            "Faceted by mode of inheritance") +
    ylab("Count")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

\hfill

```{r pairwise_age}
display.df <-  grand.data[grand.data$at_what_age_were_you_diagnosed_with_nf1. != "", c('at_what_age_were_you_diagnosed_with_nf1.','age_of_diagnosis')]

colnames(display.df) <- c('Parent','Child')
display.df <- display.df[display.df$Parent != 'Unknown',]
display.df$Parent <- as.numeric(display.df$Parent)

if (save_images) {
    filename <- 'AgeOfDiagnosisFamilialRelationship.png'
    tiff(filename = paste(images_dir, filename, sep = ""),
    units = 'in',
    width = 8,
    height = 5,
    res = 300)
}

ggpaired(display.df,
         cond1 = 'Parent',
         cond2 = 'Child',
         fill = 'condition',
         palette = 'jco',
         xlab = "",
         ylab = "Age of Diagnosis",
         ggtheme = theme_gray()) +
  theme(legend.position = 'none') +
  ggtitle("Familial Relationship: Age of Diagnosis")

if (save_images) {
    dev.off()
    print(paste("Open", paste(images_dir, filename, sep = ""), "to see the associated plot."))
}
```

# References

[1] McDonald, J.H. (2014). Handbook of Biological Statistics (3rd ed.). Sparky House Publishing, Baltimore, Maryland.

[2] Privitera, G. (2012). Statistics for the behavioral sciences. Thousand Oaks, CA: SAGE, p.367.